import datetime
import math
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from pyscf import gto, scf, mcscf, scf
starttime = datetime.datetime.now()
atom_O1 = [
                   ''' O                  0.88643217   -1.22352247    0.01370382''' , #1.4
                   '''O                  0.97937762   -1.40031168    0.00337337''',  #1.6
                    '''O                  1.07232307   -1.57710089   -0.00695709''',   #1.8
                    '''O                  1.16526852   -1.75389010   -0.01728754''' ,   #2.0
                    '''O                  1.29404100   -1.99882500   -0.03160000''' ,#2.27
                    '''O                  1.35115942   -2.10746852   -0.03794845''',   #2.4
                    '''O                  1.44410487   -2.28425773   -0.04827810''',  #2.6
                    '''O                  1.53705032   -2.46104694   -0.05860935''',   #2.8
                     '''O                  1.62999577   -2.63783615   -0.06893980''',  #3.0
                    '''O                  1.72294122   -2.81462536   -0.07927025''', #3.2    
                    ''' O                  2.09472304   -3.52178219   -0.12059209   ''',#4
                    ''' O                  2.55945030   -4.40572824   -0.17224436 ''',#5
                    '''O                  3.02417756   -5.28967429   -0.22389663  ''',#6
                    ''' O                  3.48890482   -6.17362034   -0.27554890   ''',#7
                    ]            
atom_C =  [
                 ''' C                  1.53750217   -2.21907347    0.11082282''',  #1.4
                 ''' C                  1.63044762   -2.39586268    0.10049237''',  #1.6
                 '''C                  1.72339307   -2.57265189    0.09016191''', #1.8
                  '''C                  1.81633852   -2.74944110    0.07983146''' , #2.0
                  '''C                  1.94511100   -2.99437600    0.06551900 ''' , #2.27
                  '''C                  2.00222942   -3.10301952    0.05917055''' ,  #2.4
                  '''C                  2.09517487   -3.27980873    0.04884010''' ,#2.6
                  '''C                  2.18812032   -3.45659794    0.03850965''',  #2.8
                  ''' C                  2.28106577   -3.63338715    0.02817920''',  #3.0
                  '''C                  2.37401122   -3.81017636    0.01784875 ''',  #3.2
                  ''' C                  2.74579304   -4.51733319   -0.02347309''',#4
                  ''' C                  3.21052030   -5.40127924   -0.07512536  ''',#5
                  '''C                  3.67524756   -6.28522529   -0.12677763  ''',#6
                  '''  C                  4.13997482   -7.16917134   -0.17842990 ''',#7
                  ]
atom_O2 = [
                   ''' O                  2.17455917   -3.19785247    0.20096182''',   #1.4
                   ''' O                  2.26750462   -3.37464168    0.19063137''',  #1.6
                    '''O                  2.36045007   -3.55143089    0.18030091''', #1.8
                    '''O                  2.45339552   -3.72822010    0.16997046''',  #2.0
                   '''O                  2.58216800   -3.97315500    0.15565800''' , #2.27
                   '''O                  2.63928642   -4.08179852    0.14930955''' , #2.4
                   '''O                  2.73223187   -4.25858773    0.13897910''',   #2.6
                    '''O                  2.82517732   -4.43537694    0.12864865''',  #2.8
                   '''O                  2.91812277   -4.61216615    0.11831820''',   #3.0
                   '''O                  3.01106822   -4.78895536    0.10798775''',  #3.2
                   ''' O                  3.38285004   -5.49611219    0.06666591   ''',#4
                   '''O                  3.84757730   -6.38005824    0.01501364  ''',#5
                   '''O                  4.31230456   -7.26400429   -0.03663863  ''',#6
                   '''O                  4.77703182   -8.14795034   -0.08829090  ''',#7
                       ]
atom_xx = '''\
Mg                 0.23581400    0.01400200    0.08601700
 C                  3.13653000    1.27945000    0.09157700
 C                 -1.58836500    2.61719000    0.21147500
 C                 -2.74256100   -1.29394400   -0.27756100
 O                 -0.60188700    1.86590600    0.23758000
 O                 -1.50909500   -1.05825700   -0.19035500
 O                 -0.49436300   -0.54178200    1.90290800
 C                 -1.53117600    4.08853200    0.45254700
 H                 -1.88330000    4.63865100   -0.42335400
 H                 -2.16659600    4.36963700    1.29552300
 H                 -0.51238100    4.39022100    0.66807300
 O                 -2.80068300    2.05128500   -0.05755600
 H                 -3.54895500    2.67791100   -0.06905200
 O                 -3.36348900   -1.65706100    0.84957000
 H                 -4.31598000   -1.86052400    0.77323500
 O                  3.32062900    1.43209600   -1.24082400
 H                  4.14642200    1.87826500   -1.50966300
 C                 -0.62659100   -1.39739800    2.98898000
 H                 -0.25335200   -0.83578200    3.87707200
 H                 -1.68443800   -1.56645200    3.22977700
 H                 -0.06487700   -2.32661000    2.90017600
 C                  4.18083700    1.77678500    1.03275300
 H                  5.13880300    1.28619700    0.84424900
 H                  4.33437800    2.85111600    0.90619800
 H                  3.88366600    1.58435800    2.05761900
 O                  2.08551200    0.71463900    0.45171800
 O                  0.02455400   -0.01690600   -1.92242000
 C                  0.50719000   -0.54643700   -3.11638800
 H                 -0.26667500   -0.58272900   -3.88953700
 H                  1.25745500    0.18143400   -3.50556000
 H                  1.02832900   -1.49975900   -2.99885200
 C                 -3.48378700   -1.23209000   -1.57009000
 H                 -2.95511500   -0.59151400   -2.26775300
 H                 -3.55199400   -2.23544600   -2.00114400
 H                 -4.49738400   -0.85679000   -1.42951400
'''

len_atom_O1 = len(atom_O1)   
np_Mg = np.array([0.23581400, 0.01400200, 0.08601700])   
np_O1 = np.zeros((len_atom_O1, 3))
np_C = np.zeros((len_atom_O1, 3))
np_O2 = np.zeros((len_atom_O1, 3))
print(len_atom_O1)  
print(np_O1)
print(np_Mg)  
for i in range(len_atom_O1):   
    O_coordinate = atom_O1[i].split()
    print(O_coordinate) 
    np_O1[i, 0] = float(O_coordinate[1])
    np_O1[i, 1] = float(O_coordinate[2])
    np_O1[i, 2] = float(O_coordinate[3])
print("np_o:\n", np_O1) 
for i in range(len_atom_O1):   
    C_coordinate = atom_C[i].split()
    print(C_coordinate)
    np_C[i, 0] = float(C_coordinate[1])
    np_C[i, 1] = float(C_coordinate[2])
    np_C[i, 2] = float(C_coordinate[3])
print("np_C:\n", np_C) 
for i in range(len_atom_O1):    
    OO_coordinate = atom_O2[i].split()
    print(OO_coordinate)
    np_O2[i, 0] = float(OO_coordinate[1])
    np_O2[i, 1] = float(OO_coordinate[2])
    np_O2[i, 2] = float(OO_coordinate[3])

print("np_O2:\n", np_O2) 

length = []
for i in range(len_atom_O1):
    length.append(np.linalg.norm(np_O1[i, :] - np_Mg))
for i in range(len_atom_O1):
    print("point = ", i)
    print("length: ", length[i])
    atom =  atom_xx + atom_O1[i] +"\n" + atom_C[i] + "\n" + atom_O2[i]
    print(atom)
    
    mol = gto.M(atom=atom,
           #verbose=4,
		   #symmetry=True,
            basis='sto-3g',
            charge=2,
            spin=0)  # 定义原子各种属性
    myhf = mol.HF().run() 
    mycas = mcscf.CASCI(myhf, 10, 10)
    mycas.kernel()
    
    endtime = datetime.datetime.now()
    seconds = (endtime - starttime).seconds
    print("Time:", seconds)
    print("###############################################################################")
